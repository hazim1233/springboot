package com.example.demo;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import java.util.*;
@RestController
@RequestMapping("/persons")
public class PersonController {
	 private Map<Long, Person> persons = new HashMap<>();
	    private Long nextId = 1L;

	    // CREATE (POST)
	    @PostMapping
	    public Person createPerson(@RequestBody Person person) {
	        person.setId(nextId++);
	        persons.put(person.getId(), person);
	        return person;
	    }

	    // READ ALL (GET)
	    @GetMapping
	    public Collection<Person> getAllPersons() {
	        return persons.values();
	    }

	    // READ ONE (GET)
	    @GetMapping("/{id}")
	    public ResponseEntity<Person> getPersonById(@PathVariable Long id) {
	        Person person = persons.get(id);
	        if (person != null) {
	            return ResponseEntity.ok(person);
	        } else {
	            return ResponseEntity.notFound().build();
	        }
	    }


	    // UPDATE (PUT)
	    @PutMapping("/{id}")
	    public Person updatePerson(@PathVariable Long id, @RequestBody Person person) {
	        if (persons.containsKey(id)) {
	            person.setId(id);
	            persons.put(id, person);
	            return person;
	        }
	        return null;
	    }

	    // DELETE
	    @DeleteMapping("/{id}")
	    public String deletePerson(@PathVariable Long id) {
	        persons.remove(id);
	        return "Person with id " + id + " deleted.";
	    }
	

}
